View(res)
library(ggpubr)
cor_fun <- function(df) cor.test(df$weight, df$all_bins_value, method = "spearman") %>% tidy()
res <- ddply(sell, .(date,species), cor_fun)
sell
cor(sell$all_bins_value,sell$weight)
sell
cor(sell$all_bins_value,sell$weight)
cor(sell$all_bins_value,sell$weight)
sell
x <- cor(sell$all_bins_value,sell$weight)
x
require(plyr)
func <- function(xx)
{
return(data.frame(COR = cor(xx$weight, xx$all_bins_value)))
}
res <- ddply(sell, .(date,species), func)
View(res)
res <- ddply(sell, .(date,genus), func)
View(res)
sel <- all %>%
dplyr::filter(genus=="Acinetobacter") # no pos corr
sel <- cSplit(indt = sel, "sample", sep = "_", drop = NA)
sel %>%
dplyr::filter(date=="t0"|date=="t2"|date=="t4"|date=="t6"|
date=="t8"|date=="t10") %>%
ggplot(., aes(x=weight,y=all_bins_value))+
geom_point(size=0.5) +
facet_wrap(~date, scale="free", shrink = TRUE)+
stat_smooth(method="lm", se=TRUE) +
stat_cor(p.accuracy = 0.001, r.accuracy = 0.01)
# select those with weight data
sell <- sel %>%
dplyr::filter(date=="t0"|date=="t2"|date=="t4"|date=="t6"|
date=="t8"|date=="t10") %>%
group_by(species,date) %>%
dplyr::mutate(num=n()) %>%
dplyr::filter(num>10)
require(plyr)
func <- function(xx)
{
return(data.frame(COR = cor(xx$weight, xx$all_bins_value)))
}
res <- ddply(sell, .(date,genus), func)
View(res)
sel <- all
sel <- cSplit(indt = sel, "sample", sep = "_", drop = NA)
# select those with weight data
sell <- sel %>%
dplyr::filter(date=="t0"|date=="t2"|date=="t4"|date=="t6"|
date=="t8"|date=="t10") %>%
group_by(species,date) %>%
dplyr::mutate(num=n()) %>%
dplyr::filter(num>10)
require(plyr)
func <- function(xx)
{
return(data.frame(COR = cor(xx$weight, xx$all_bins_value)))
}
sell
res <- ddply(sell, .(date,genus), func)
View(res)
all <- inner_join(df2_taxamat,sample_df)
sel <- all %>%
dplyr::filter(genus=="Streptomyces")
sel <- cSplit(indt = sel, "sample", sep = "_", drop = NA)
sel %>%
dplyr::filter(date=="t0"|date=="t2"|date=="t4"|date=="t6"|
date=="t8"|date=="t10") %>%
ggplot(., aes(x=weight,y=all_bins_value))+
geom_point(size=0.5) +
facet_wrap(~date, scale="free", shrink = TRUE)+
stat_smooth(method="lm", se=TRUE) +
stat_cor(p.accuracy = 0.001, r.accuracy = 0.01)
sel <- all
sel <- cSplit(indt = sel, "sample", sep = "_", drop = NA)
# select those with weight data
sell <- sel %>%
dplyr::filter(date=="t0"|date=="t2"|date=="t4"|date=="t6"|
date=="t8"|date=="t10") %>%
group_by(species,date) %>%
dplyr::mutate(num=n()) %>%
dplyr::filter(num>10)
sell
View(sell)
sel <- all
sel <- cSplit(indt = sel, "sample", sep = "_", drop = NA)
sel$date = sel$sample_1
# select those with weight data
sell <- sel %>%
dplyr::filter(date=="t0"|date=="t2"|date=="t4"|date=="t6"|
date=="t8"|date=="t10") %>%
group_by(species,date) %>%
dplyr::mutate(num=n()) %>%
dplyr::filter(num>10)
View(sell)
require(plyr)
func <- function(xx)
{
return(data.frame(COR = cor(xx$weight, xx$all_bins_value)))
}
res <- ddply(sell, .(date,genus), func)
View(res)
sel <- all
sel <- cSplit(indt = sel, "sample", sep = "_", drop = NA)
sel$date = sel$sample_1
# select those with weight data
sell <- sel %>%
dplyr::filter(date=="t0"|date=="t2"|date=="t4"|date=="t6"|
date=="t8"|date=="t10") %>%
dplyr::filter(species=="Streptomyces")
# select those with weight data
sell <- sel %>%
dplyr::filter(date=="t0"|date=="t2"|date=="t4"|date=="t6"|
date=="t8"|date=="t10") %>%
dplyr::filter(species=="Streptomyces") %>%
ggplot(., aes(x=weight,y=all_bins_value))+
geom_point(size=0.5) +
facet_wrap(~date, scale="free", shrink = TRUE)+
stat_smooth(method="lm", se=TRUE) +
stat_cor(p.accuracy = 0.001, r.accuracy = 0.01)
all <- inner_join(df2_taxamat,sample_df)
sel <- all
sel <- cSplit(indt = sel, "sample", sep = "_", drop = NA)
sel$date = sel$sample_1
sel %>%
dplyr::filter(date=="t0"|date=="t2"|date=="t4"|date=="t6"|
date=="t8"|date=="t10") %>%
dplyr::filter(species=="Streptomyces")
# select those with weight data
sell <- sel %>%
dplyr::filter(date=="t0"|date=="t2"|date=="t4"|date=="t6"|
date=="t8"|date=="t10") %>%
dplyr::filter(genus=="Streptomyces") %>%
ggplot(., aes(x=weight,y=all_bins_value))+
geom_point(size=0.5) +
facet_wrap(~date, scale="free", shrink = TRUE)+
stat_smooth(method="lm", se=TRUE) +
stat_cor(p.accuracy = 0.001, r.accuracy = 0.01)
sel %>%
dplyr::filter(date=="t0"|date=="t2"|date=="t4"|date=="t6"|
date=="t8"|date=="t10") %>%
dplyr::filter(genus=="Streptomyces")
test <- sel %>%
dplyr::filter(date=="t0"|date=="t2"|date=="t4"|date=="t6"|
date=="t8"|date=="t10") %>%
dplyr::filter(genus=="Streptomyces")
View(test)
sel %>%
dplyr::filter(date=="t0"|date=="t2"|date=="t4"|date=="t6"|
date=="t8"|date=="t10") %>%
group_by(species,date) %>%
dplyr::mutate(num=sum())
sel <- all
sel <- cSplit(indt = sel, "sample", sep = "_", drop = NA)
sel$date = sel$sample_1
# select those with weight data
sell <- sel %>%
dplyr::filter(date=="t0"|date=="t2"|date=="t4"|date=="t6"|
date=="t8"|date=="t10") %>%
group_by(species,date) %>%
dplyr::mutate(num=sum()) %>%
dplyr::filter(num>10)
View(sell)
sel <- all
sel <- cSplit(indt = sel, "sample", sep = "_", drop = NA)
sel$date = sel$sample_1
sel$n = 1
# select those with weight data
sell <- sel %>%
dplyr::filter(date=="t0"|date=="t2"|date=="t4"|date=="t6"|
date=="t8"|date=="t10") %>%
group_by(species,date) %>%
dplyr::mutate(n=sum(n)) %>%
dplyr::filter(num>10)
sel <- all
sel <- cSplit(indt = sel, "sample", sep = "_", drop = NA)
sel$date = sel$sample_1
sel$n = 1
sell <- sel %>%
dplyr::filter(date=="t0"|date=="t2"|date=="t4"|date=="t6"|
date=="t8"|date=="t10") %>%
group_by(species,date) %>%
dplyr::mutate(num=sum(n))
sel <- all
sel <- cSplit(indt = sel, "sample", sep = "_", drop = NA)
sel$date = sel$sample_1
sel$n = 1
# select those with weight data
sell <- sel %>%
dplyr::filter(date=="t0"|date=="t2"|date=="t4"|date=="t6"|
date=="t8"|date=="t10") %>%
group_by(species,date) %>%
dplyr::mutate(num=sum(n)) %>%
dplyr::filter(num>10)
View(sell)
sel <- all
sel <- cSplit(indt = sel, "sample", sep = "_", drop = NA)
sel$date = sel$sample_1
sel$n = 1
# select those with weight data
sell <- sel %>%
dplyr::filter(date=="t0"|date=="t2"|date=="t4"|date=="t6"|
date=="t8"|date=="t10") %>%
group_by(species,date) %>%
dplyr::mutate(num=sum(n)) %>%
dplyr::filter(num>10)
func <- function(xx)
{
return(data.frame(COR = cor(xx$weight, xx$all_bins_value)))
}
res <- ddply(sell, .(date,genus), func)
View(res)
sel <- all
sel <- cSplit(indt = sel, "sample", sep = "_", drop = NA)
sel$date = sel$sample_1
sel$n = 1
# select those with weight data
sell <- sel %>%
dplyr::filter(date=="t0"|date=="t2"|date=="t4"|date=="t6"|
date=="t8"|date=="t10") %>%
group_by(genus,date) %>%
dplyr::mutate(num=sum(n)) %>%
dplyr::filter(num>10)
require(plyr)
func <- function(xx)
{
return(data.frame(COR = cor(xx$weight, xx$all_bins_value)))
}
res <- ddply(sell, .(date,genus), func)
View(res)
sel <- all
sel <- cSplit(indt = sel, "sample", sep = "_", drop = NA)
sel$date = sel$sample_1
# select those with weight data
sell <- sel %>%
dplyr::filter(date=="t0"|date=="t2"|date=="t4"|date=="t6"|
date=="t8"|date=="t10") %>%
dplyr::filter(genus=="Sutterella") %>%
ggplot(., aes(x=weight,y=all_bins_value))+
geom_point(size=0.5) +
facet_wrap(~date, scale="free", shrink = TRUE)+
stat_smooth(method="lm", se=TRUE) +
stat_cor(p.accuracy = 0.001, r.accuracy = 0.01)
# select those with weight data
sel %>%
dplyr::filter(date=="t0"|date=="t2"|date=="t4"|date=="t6"|
date=="t8"|date=="t10") %>%
dplyr::filter(genus=="Sutterella") %>%
ggplot(., aes(x=weight,y=all_bins_value))+
geom_point(size=0.5) +
facet_wrap(~date, scale="free", shrink = TRUE)+
stat_smooth(method="lm", se=TRUE) +
stat_cor(p.accuracy = 0.001, r.accuracy = 0.01)
# select those with weight data
sel %>%
dplyr::filter(date=="t0"|date=="t2"|date=="t4"|date=="t6"|
date=="t8"|date=="t10") %>%
dplyr::filter(genus=="Coprococcus") %>%
ggplot(., aes(x=weight,y=all_bins_value))+
geom_point(size=0.5) +
facet_wrap(~date, scale="free", shrink = TRUE)+
stat_smooth(method="lm", se=TRUE) +
stat_cor(p.accuracy = 0.001, r.accuracy = 0.01)
sel <- all
sel <- cSplit(indt = sel, "sample", sep = "_", drop = NA)
sel$date = sel$sample_1
sel$n = 1
# select those with weight data
sell <- sel %>%
dplyr::filter(date=="t0"|date=="t2"|date=="t4"|date=="t6"|
date=="t8"|date=="t10") %>%
group_by(genus,date) %>%
dplyr::mutate(num=sum(n)) %>%
dplyr::filter(num>20)
require(plyr)
func <- function(xx)
{
return(data.frame(COR = cor(xx$weight, xx$all_bins_value)))
}
res <- ddply(sell, .(date,genus), func)
View(res)
sel <- all
sel <- cSplit(indt = sel, "sample", sep = "_", drop = NA)
sel$date = sel$sample_1
# select those with weight data
sel %>%
dplyr::filter(date=="t0"|date=="t2"|date=="t4"|date=="t6"|
date=="t8"|date=="t10") %>%
dplyr::filter(genus=="Clostridium_AI") %>%
ggplot(., aes(x=weight,y=all_bins_value))+
geom_point(size=0.5) +
facet_wrap(~date, scale="free", shrink = TRUE)+
stat_smooth(method="lm", se=TRUE) +
stat_cor(p.accuracy = 0.001, r.accuracy = 0.01)
sel %>%
dplyr::filter(date=="t0"|date=="t2"|date=="t4"|date=="t6"|
date=="t8"|date=="t10") %>%
dplyr::filter(genus=="Tyzzerella") %>%
ggplot(., aes(x=weight,y=all_bins_value))+
geom_point(size=0.5) +
facet_wrap(~date, scale="free", shrink = TRUE)+
stat_smooth(method="lm", se=TRUE) +
stat_cor(p.accuracy = 0.001, r.accuracy = 0.01)
sel <- all
sel <- cSplit(indt = sel, "sample", sep = "_", drop = NA)
sel$date = sel$sample_1
sel$n = 1
# select those with weight data
sell <- sel %>%
dplyr::filter(date=="t0"|date=="t2"|date=="t4"|date=="t6"|
date=="t8"|date=="t10") %>%
group_by(genus,date) %>%
dplyr::mutate(num=sum(n)) %>%
dplyr::filter(num>20)
sel <- all
sel <- cSplit(indt = sel, "sample", sep = "_", drop = NA)
sel$date = sel$sample_1
sel$n = 1
# select those with weight data
sell <- sel %>%
dplyr::filter(date=="t4") %>%
group_by(genus,date) %>%
dplyr::mutate(num=sum(n)) %>%
dplyr::filter(num>20)
wilcox.test(sell$weight ~ sell$all_bins_value)
sel <- all
sel <- cSplit(indt = sel, "sample", sep = "_", drop = NA)
sel$date = sel$sample_1
sel$n = 1
# select those with weight data
sell <- sel %>%
dplyr::filter(date=="t0"|date=="t2"|date=="t4"|date=="t6"|
date=="t8"|date=="t10") %>%
group_by(genus,date) %>%
dplyr::mutate(num=sum(n)) %>%
dplyr::filter(num>20)
require(plyr)
func <- function(xx)
{
return(data.frame(COR = cor(xx$weight, xx$all_bins_value, method = "spearman")))
}
res <- ddply(sell, .(date,genus), func)
View(res)
sel <- all
sel <- cSplit(indt = sel, "sample", sep = "_", drop = NA)
sel$date = sel$sample_1
# select those with weight data
sel %>%
dplyr::filter(date=="t0"|date=="t2"|date=="t4"|date=="t6"|
date=="t8"|date=="t10") %>%
dplyr::filter(genus=="Bacillus_A") %>%
ggplot(., aes(x=weight,y=all_bins_value))+
geom_point(size=0.5) +
facet_wrap(~date, scale="free", shrink = TRUE)+
stat_smooth(method="lm", se=TRUE) +
stat_cor(p.accuracy = 0.001, r.accuracy = 0.01)
# select those with weight data
sel %>%
dplyr::filter(date=="t0"|date=="t2"|date=="t4"|date=="t6"|
date=="t8"|date=="t10") %>%
dplyr::filter(genus=="Bacillus_A") %>%
ggplot(., aes(x=weight,y=log(all_bins_value)))+
geom_point(size=0.5) +
facet_wrap(~date, scale="free", shrink = TRUE)+
stat_smooth(method="lm", se=TRUE) +
stat_cor(p.accuracy = 0.001, r.accuracy = 0.01)
sel <- all
sel <- cSplit(indt = sel, "sample", sep = "_", drop = NA)
sel$date = sel$sample_1
# select those with weight data
sel %>%
dplyr::filter(date=="t0"|date=="t2"|date=="t4"|date=="t6"|
date=="t8"|date=="t10") %>%
dplyr::filter(genus=="Lactobacillus") %>%
ggplot(., aes(x=weight,y=log(all_bins_value)))+
geom_point(size=0.5) +
facet_wrap(~date, scale="free", shrink = TRUE)+
stat_smooth(method="lm", se=TRUE) +
stat_cor(p.accuracy = 0.001, r.accuracy = 0.01)
sel <- all
sel <- cSplit(indt = sel, "sample", sep = "_", drop = NA)
sel$date = sel$sample_1
# select those with weight data
sel %>%
dplyr::filter(date=="t0"|date=="t2"|date=="t4"|date=="t6"|
date=="t8"|date=="t10") %>%
dplyr::filter(species=="Lactobacillus amylovorus") %>%
ggplot(., aes(x=weight,y=log(all_bins_value)))+
geom_point(size=0.5) +
facet_wrap(~date, scale="free", shrink = TRUE)+
stat_smooth(method="lm", se=TRUE) +
stat_cor(p.accuracy = 0.001, r.accuracy = 0.01)
sel <- all
sel <- cSplit(indt = sel, "sample", sep = "_", drop = NA)
sel$date = sel$sample_1
sel$n = 1
# select those with weight data
sell <- sel %>%
dplyr::filter(date=="t0"|date=="t2"|date=="t4"|date=="t6"|
date=="t8"|date=="t10") %>%
group_by(genus,date) %>%
dplyr::mutate(num=sum(n)) %>%
dplyr::filter(num>20)
res <- ddply(sell, .(date,species), func)
View(res)
sel <- all
sel <- cSplit(indt = sel, "sample", sep = "_", drop = NA)
sel$date = sel$sample_1
# select those with weight data
sel %>%
dplyr::filter(date=="t0"|date=="t2"|date=="t4"|date=="t6"|
date=="t8"|date=="t10") %>%
dplyr::filter(species=="Blautia sp000432195") %>%
ggplot(., aes(x=weight,y=log(all_bins_value)))+
geom_point(size=0.5) +
facet_wrap(~date, scale="free", shrink = TRUE)+
stat_smooth(method="lm", se=TRUE) +
stat_cor(p.accuracy = 0.001, r.accuracy = 0.01)
sel <- all
sel <- cSplit(indt = sel, "sample", sep = "_", drop = NA)
sel$date = sel$sample_1
sel$n = 1
# select those with weight data
sell <- sel %>%
dplyr::filter(date=="t0"|date=="t2"|date=="t4"|date=="t6"|
date=="t8"|date=="t10") %>%
group_by(species,date) %>%
dplyr::mutate(num=sum(n)) %>%
dplyr::filter(num>20)
require(plyr)
func <- function(xx)
{
return(data.frame(COR = cor(xx$weight, xx$all_bins_value, method = "spearman")))
}
res <- ddply(sell, .(date,species), func)
View(res)
sel <- all
sel <- cSplit(indt = sel, "sample", sep = "_", drop = NA)
sel$date = sel$sample_1
# select those with weight data
sel %>%
dplyr::filter(date=="t0"|date=="t2"|date=="t4"|date=="t6"|
date=="t8"|date=="t10") %>%
dplyr::filter(species=="Bacillus_A thuringiensis_J") %>%
ggplot(., aes(x=weight,y=log(all_bins_value)))+
geom_point(size=0.5) +
facet_wrap(~date, scale="free", shrink = TRUE)+
stat_smooth(method="lm", se=TRUE) +
stat_cor(p.accuracy = 0.001, r.accuracy = 0.01)
NROW(res)
res %>%
dplyr::filter(COR > 0.3 & COR < -0.3)
ress <- res %>%
dplyr::filter(!COR %in% (-0.3:0.3))
NROW(ress)
NROW(res)
# filter out weak correlations
ress <- res %>%
dplyr::filter(COR %in% (-0.3:0.3))
ress
# filter out weak correlations
ress <- res %>%
dplyr::filter(COR>-0.3&x<0.3)
ress
# filter out weak correlations
ress <- res %>%
dplyr::filter(COR>-0.3&COR<0.3)
ress
View(ress)
anti_join(res,ress)
# filter out weak correlations
ress <- res %>%
dplyr::filter(!COR>-0.3&COR<0.3)
ress
View(ress)
# filter out weak correlations
ress <- res %>%
dplyr::filter(!COR>-0.3&!COR<0.3)
# filter out weak correlations
ress <- res %>%
dplyr::filter(between(COR, -0.3, 0.3))
ress
# filter out weak correlations
ress <- res %>%
dplyr::filter(!between(COR, -0.3, 0.3))
ress
View(ress)
sel <- all
sel <- cSplit(indt = sel, "sample", sep = "_", drop = NA)
sel$date = sel$sample_1
# select those with weight data
sel %>%
dplyr::filter(date=="t0"|date=="t2"|date=="t4"|date=="t6"|
date=="t8"|date=="t10") %>%
dplyr::filter(species=="Methanobrevibacter_A gottschalkii") %>%
ggplot(., aes(x=weight,y=log(all_bins_value)))+
geom_point(size=0.5) +
facet_wrap(~date, scale="free", shrink = TRUE)+
stat_smooth(method="lm", se=TRUE) +
stat_cor(p.accuracy = 0.001, r.accuracy = 0.01)
# select those with weight data
sel %>%
dplyr::filter(date=="t0"|date=="t2"|date=="t4"|date=="t6"|
date=="t8"|date=="t10") %>%
dplyr::filter(species=="Eubacterium callanderi") %>%
ggplot(., aes(x=weight,y=log(all_bins_value)))+
geom_point(size=0.5) +
facet_wrap(~date, scale="free", shrink = TRUE)+
stat_smooth(method="lm", se=TRUE) +
stat_cor(p.accuracy = 0.001, r.accuracy = 0.01)
